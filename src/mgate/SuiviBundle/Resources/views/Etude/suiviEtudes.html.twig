{% extends "mgateSuiviBundle::layout.html.twig" %}

{% block title %}
Récapitulatif - Suivi d'étude - {{ parent() }}
{% endblock %}

{% block content_bundle %}
<link rel="stylesheet" href="{{ asset('css/gantt.css')}}" /> 
<div class="gantt" id="ganttId1"></div>




<table class="table table-striped table-bordered">
    <tr>
        <th>Référence</th>
        <th>Sujet</th>
        <th>Client</th>
        <th>Suiveur de projet</th>
        <th>Signé</th>
        <th>Commentaires</th>
    </tr>
    {% for mandat in etudesParMandat | reverse %}
    {% if mandat |length %}
    <tr>
        <th colspan="6">Mandat {{(etudesParMandat | length - loop.index0)}}</th>
    </tr>
    {% endif %}
        {% for etude in mandat %}
    {% set signe = ( etude.cc ? etude.cc.spt1 and etude.cc.spt2 : false )%}
    <tr class="{{ (etude.stateID == 4 ? "success" : (etude.stateID == 3 ? "error" : (etude.stateID == 2 ? "warning" : "info"))) }}">
        <td><a href="{{ path('mgateSuivi_etude_voir', {'id': etude.id}) }}"> {{ getRefEtude(etude) }}</a></td>
        <td>{{ etude.nom }}</td>
        <td>{% include "mgateSuiviBundle:Etude:Buttons/Prospect.html.twig" with  {'prospect':  etude.prospect} %}</td>
        <td>{% include "mgateSuiviBundle:Etude:Buttons/Suiveur.html.twig" with  {'suiveur':  etude.suiveur} %}</td>
        <td>{% if signe %}<span class="badge badge-success">Oui</span>{% else %}<span class="badge badge-important">Non</span>{% endif %}</td>
        <td>
            <a id="commentaire" class="btn" href="#" data-title="{{ etude.id }}" data-content="0">
                <i class="icon-comment"></i> 
            </a> {{ etude.stateDescription }}</td>
    </tr>
    {% endfor %}
    {% endfor %}
</table>

{{ dump(form.stateDescription) }}
{{ form_widget(form.stateDescription) }}
{% for description in form.stateDescription %}
    
{% endfor %}
{% endblock %}

{% block javascript %}
    {{ parent() }}
<script src="{{ asset('js/jquery.fn.gantt.js')}}"></script>
<script>
    
    {% include "mgateSuiviBundle:Etude:Tools/CommentairesSuivi.js.twig" %}
    {% include "mgateSuiviBundle:Etude:Blocks/ganttSuivi.js.twig" %}
</script>
{% endblock %}